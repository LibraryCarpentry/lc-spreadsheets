<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Tidy data for librarians: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/lc/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/lc/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/lc/favicon-16x16.png">
<link rel="manifest" href="../favicons/lc/site.webmanifest">
<link rel="mask-icon" href="../favicons/lc/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav library"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="lc-logo" alt="Library Carpentry" src="../assets/images/library-logo.svg">
</div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="../assets/images/library-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Tidy data for librarians
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Tidy data for librarians
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="jargon_busting.html">Jargon Busting</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Tidy data for librarians
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-intro.html">1. Using spreadsheet programs for data organization</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-format-data.html">2. Formatting data tables in Spreadsheets</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-common-mistakes.html">3. Formatting problems</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-dates-as-data.html">4. Dates as data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-quality-control.html">5. Basic quality assurance and control</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-exporting-data.html">6. Exporting data from spreadsheets</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-data-formats-caveats.html">7. Caveats of popular data and file formats</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="jargon_busting.html">Jargon Busting</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-intro"><p>Content from <a href="00-intro.html">Using spreadsheet programs for data organization</a></p>
<hr>
<p>Last updated on 2024-06-22 |

        <a href="https://github.com/librarycarpentry/lc-spreadsheets/edit/main/episodes/00-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are good data practices for using spreadsheets for organizing
data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understanding some drawbacks and advantages of using spreadsheet
programs</li>
<li>Distinguish machine readable tidy data from data that is easy to
read for humans</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Narrative Guidance </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<ul>
<li>Introduce that we’re teaching data organization, and that we’re
using spreadsheets, because most people do data entry in spreadsheets or
have data in spreadsheets.</li>
<li>Emphasize that we are teaching good practice in data organization
and that this is the foundation of their research practice. Without
organized and clean data, it will be difficult for them to apply the
things we’re teaching in the rest of the workshop to their data.</li>
<li>Much of their lives as a researcher will be spent on this ‘data
wrangling’ stage, but some of it can be prevented with good strategies
for data collection up front.</li>
<li>Tell that we’re not teaching data analysis or plotting in
spreadsheets, because it’s very manual and also not reproducible. That’s
why we’re teaching SQL, R, Python!</li>
<li>Now let’s talk about spreadsheets, and when we say spreadsheets, we
mean any program that does spreadsheets like Excel, LibreOffice,
OpenOffice. Most learners are probably using Excel.</li>
<li>Ask the audience any things they’ve accidentally done in
spreadsheets. Talk about an example of your own, like that you
accidentally sorted only a single column and not the rest of the data in
the spreadsheet. What are the pain points!?</li>
<li>As people answer highlight some of these issues with
spreadsheets</li>
</ul>
</div>
</div>
</div>
</div>
<p>Good <strong>data organization</strong> is the foundation of much of
our day-to-day work in libraries. Most <strong>librarians</strong> have
data or do data entry in spreadsheets. Spreadsheet programs are very
<strong>useful graphical interfaces</strong> for designing data tables
and handling very basic data quality control functions.</p>
<p>Spreadsheets encompass a lot of the things we need to be able to do
as librarians. We can use them for:</p>
<ul>
<li>Data entry</li>
<li>Organizing data</li>
<li>Subsetting and sorting data</li>
<li>Statistics</li>
<li>Plotting</li>
</ul>
<div id="jargon-busting-optional-not-included-in-timing" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="jargon-busting-optional-not-included-in-timing" class="callout-inner">
<h3 class="callout-title">Jargon busting (Optional, not included in timing)</h3>
<div class="callout-content">
<p>The <a href="jargon_busting.html">Jargon Busting exercise</a> is a
helpful way to begin to explore terms, phrases, and ideas related to
code and software development.</p>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" aria-labelledby="headingInstructor2" data-bs-parent="#accordionInstructor2">
<div class="accordion-body">
<p>This exercise can be useful when you teach Tidy Data as the
introduction to a full LC workshop, especially if you want learners to
have an opportunity to meet each other and interact. It can take
anywhere from 10 to 45 minutes, depending on your approach.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="spreadsheet-outline">Spreadsheet outline<a class="anchor" aria-label="anchor" href="#spreadsheet-outline"></a>
</h3>
<p>In this lesson, we will look at:</p>
<ul>
<li>Good data entry practices - formatting data tables in
spreadsheets</li>
<li>How to avoid common formatting mistakes</li>
<li>Dates as data - beware!</li>
<li>Basic quality control and data manipulation in spreadsheets</li>
<li>Exporting data from spreadsheets</li>
</ul>
<p><strong>Much of your time when you’re producing a report will be
spent in this ‘data wrangling’ stage.</strong> It’s not the most fun,
but it’s necessary. We’ll teach you how to think about data organization
and some practices for more effective data wrangling.</p>
<hr>
</div>
<div class="section level3">
<h3 id="what-this-lesson-will-not-teach-you">What this lesson will not teach you<a class="anchor" aria-label="anchor" href="#what-this-lesson-will-not-teach-you"></a>
</h3>
<ul>
<li>How to do <em>statistics</em> in a spreadsheet</li>
<li>How to do <em>plotting</em> in a spreadsheet</li>
<li>How to <em>write code</em> in spreadsheet programs</li>
</ul>
<p>If you’re looking to do this, a good reference is <a href="https://search.worldcat.org/en/title/1263023438" class="external-link">Microsoft Excel
365 Bible</a>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="why-arent-we-teaching-data-analysis-in-spreadsheets">Why aren’t we teaching data analysis in spreadsheets<a class="anchor" aria-label="anchor" href="#why-arent-we-teaching-data-analysis-in-spreadsheets"></a>
</h3>
<ul>
<li><p>Data analysis in spreadsheets usually requires <strong>a lot of
manual work</strong>. If you want to change a parameter or run an
analysis with a new dataset, you usually have to redo everything by
hand. (We do know that you can create macros, but see the next
point.)</p></li>
<li><p>It is also difficult to <strong>track or reproduce statistical or
plotting analyses</strong> done in spreadsheet programs when you want to
go back to your work or someone asks for details of your
analysis.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="spreadsheet-programs">Spreadsheet programs<a class="anchor" aria-label="anchor" href="#spreadsheet-programs"></a>
</h3>
<p>There are a number of spreadsheet programs available for use on a
desktop or web browser:</p>
<ul>
<li>LibreOffice Calc</li>
<li>Microsoft Excel</li>
<li>Apple Numbers</li>
<li>Google Sheets</li>
<li>Gnumeric</li>
<li>Apache OpenOffice Calc</li>
</ul>
<p>Commands may differ a bit between programs, but the general idea is
the same. In this lesson, we will assume that you are most likely using
Excel as your primary spreadsheet program. There are others with similar
functionality, including Gnumeric, OpenOffice Calc, and Google Sheets,
but Excel is the package you’re most likely to have available on your
work computer.</p>
<hr>
<div id="questions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="questions" class="callout-inner">
<h3 class="callout-title">Questions:</h3>
<div class="callout-content">
<ul>
<li>How many people have used spreadsheets in their work?</li>
<li>What kind of operations do you do in spreadsheets?</li>
<li>Which ones do you think spreadsheets are good for?</li>
</ul>
</div>
</div>
</div>
<hr>
<div id="question" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="question" class="callout-inner">
<h3 class="callout-title">Question</h3>
<div class="callout-content">
<ul>
<li>Spreadsheets can be very useful, but they can also be frustrating
and even sometimes give us incorrect results. What are some things that
you’ve accidentally done in a spreadsheet, or have been frustrated that
you can’t do easily?</li>
</ul>
</div>
</div>
</div>
<hr>
</div>
<section><h2 class="section-heading" id="problems-with-spreadsheets">Problems with Spreadsheets<a class="anchor" aria-label="anchor" href="#problems-with-spreadsheets"></a>
</h2>
<hr class="half-width">
<p>Spreadsheets are <strong>good for data entry</strong>, but in reality
we <strong>tend to use spreadsheet programs for much more</strong> than
data entry. We use them to create data tables for publications, to
generate summary statistics, and make figures.</p>
<p>Generating <strong>tables for reports</strong> in a spreadsheet is
not optimal - often, when formatting a data table for publication, we’re
reporting key summary statistics in a way that is <strong>not really
meant to be read as data</strong>, and often involves <strong>special
formatting</strong> (merging cells, creating borders, making it pretty).
We advise you to do this sort of operation within your document editing
software.</p>
<p>The latter two applications, <strong>generating statistics and
figures</strong>, should be used with caution: because of the graphical,
drag and drop nature of spreadsheet programs, it can be very difficult,
if not impossible, to replicate your steps (much less retrace anyone
else’s), particularly if your stats or figures require you to do more
complex calculations. Furthermore, in doing calculations in a
spreadsheet, it’s easy to accidentally apply a slightly different
formula to multiple adjacent cells. When using a command-line based
statistics program like R or SAS, it’s practically impossible to
accidentally apply a calculation to one observation in your dataset but
not another unless you’re doing it on purpose.</p>
<div class="section level3">
<h3 id="using-spreadsheets-for-data-entry-and-cleaning">Using Spreadsheets for Data Entry and Cleaning<a class="anchor" aria-label="anchor" href="#using-spreadsheets-for-data-entry-and-cleaning"></a>
</h3>
<p><strong>HOWEVER</strong>, there are circumstances where you might
want to use a spreadsheet program to produce “quick and dirty”
calculations or figures, and some of these features can be used in
<strong>data cleaning</strong>, prior to importation into a statistical
analysis program. We will show you how to use some features of
spreadsheet programs to check your data quality along the way and
produce preliminary summary statistics.</p>
<p>In this lesson, we’re going to talk about:</p>
<ol style="list-style-type: decimal">
<li><a href="01-format-data.html">Formatting data tables in
spreadsheets</a></li>
<li><a href="02-common-mistakes.html">Formatting problems</a></li>
<li><a href="03-dates-as-data.html">Dates as data</a></li>
<li><a href="04-quality-control.html">Basic quality control and data
manipulation in spreadsheets</a></li>
<li><a href="05-exporting-data.html">Exporting data from
spreadsheets</a></li>
<li><a href="06-data-formats-caveats.html">Data export formats
caveats</a></li>
</ol>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>We will discuss good practices for data entry and formatting</li>
<li>We will not discuss analysis or visualisation</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-01-format-data"><p>Content from <a href="01-format-data.html">Formatting data tables in Spreadsheets</a></p>
<hr>
<p>Last updated on 2024-10-29 |

        <a href="https://github.com/librarycarpentry/lc-spreadsheets/edit/main/episodes/01-format-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How should data be formatted in spreadsheets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe best practices for data entry and formatting in
spreadsheets.</li>
<li>Apply best practices to arrange variables and observations in a
spreadsheet.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>
  Narrative Guidance
  </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<ul>
<li>Go through the point about keeping track of your steps and keeping
raw data raw</li>
<li>Go through the cardinal rule of spreadsheets about columns, rows and
cells</li>
<li>Hand them a messy data file and have them pair up and work together
to clean up the data. <em>Give them 15 minutes to do this.</em>
</li>
<li>Ask for what people did to clean the data. As they bring up
different points you can refer to them in the 02-common-mistakes.md
file, or expand a bit on the point they brought up. If you are just
teaching the lesson, it would be good to familiarize yourself with the
set of mistakes in 02-common-mistakes. All these mistakes are present in
the messy dataset.</li>
<li>If you get a response where they’ve fixed the date, you can pause
and go to the 03-dates-as-data.md lesson. Or you can say you’ll come
back to dates at the end. There’s an exercise in that file about how to
change the date into three columns using Excel’s built in MONTH, DAY,
YEAR functions. Have them run through that exercise.</li>
</ul>
</div>
</div>
</div>
</div>
<p>The most common mistake made is treating the program like it is a
notebook by relying on context, notes in the margin, spatial layout of
data and fields to convey information. As humans, we can (usually)
interpret these things, but computers are unintelligent, and unless we
explain to the computer what every single thing means (and that can be
hard!) it will not be able to see how our data fit together.</p>
<p>Using the power of computers, we can manage and analyze data in much
more effective and faster ways, but to use that power, we have to set up
our data for the computer to be able to understand it (and computers are
very literal).</p>
<p>This is why it’s extremely important to set up well-formatted tables
from the outset <strong>before</strong> you even start collecting data
to analyse. <strong>Data organization is the foundation of your
data-related work.</strong> Unorganized data can make it harder to work
with your data, so you should be mindful of your data organization when
doing your data entry. You’ll want to organize your data in a way that
allows other programs and people to easily understand and use the
data.</p>
<div id="callout" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="callout" class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p><strong>Note:</strong> the best layouts/formats (as well as software
and interfaces) for <strong>data entry</strong> and <strong>data
analysis</strong> might be different. It is important to take this into
account, and ideally automate the conversion from one to another.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="keeping-track-of-your-analyses">Keeping track of your analyses<a class="anchor" aria-label="anchor" href="#keeping-track-of-your-analyses"></a>
</h3>
<p>When working with spreadsheets during data clean up or analyses, it’s
very easy to end up with a spreadsheet that looks very different from
the one you started with. In order to be able to reproduce your analyses
or figure out what you did when your leadership team ask for a different
analysis, you <strong>should:</strong></p>
<ul>
<li>create a new file with your cleaned or analyzed data. Don’t modify
the original dataset, or you will never know where you started!</li>
<li>keep track of the steps you took in your clean up or analysis. You
should track these steps as you would any step in an experiment. We
recommend that you do this in a plain text file stored in the same
folder as the data file.</li>
<li>record the steps you followed in your data cleanup or analysis. Just
as you would document key actions in a research project, it’s important
to keep a clear record of your workflow. We suggest saving this
documentation in a plain text file within the same folder as your data
file for easy access and organization.</li>
</ul>
<p>This might be an example of the setup as you work:</p>
<figure><img src="../fig/spreadsheet-setup.png" alt="spreadsheet setup" class="figure mx-auto d-block"></figure><p>We will put these principles into practice today during your
exercises.</p>
</div>
<div class="section level3">
<h3 id="structuring-data-in-spreadsheets">Structuring data in spreadsheets<a class="anchor" aria-label="anchor" href="#structuring-data-in-spreadsheets"></a>
</h3>
<p>The cardinal rules of using spreadsheet programs for data:</p>
<ol style="list-style-type: decimal">
<li>Put all your <strong>variables in columns</strong> - the thing
you’re measuring, like ‘length’ or ‘attendance’.</li>
<li>Put each <strong>observation in its own row</strong>.</li>
<li>
<strong>Don’t combine multiple pieces of information in one
cell</strong>. Sometimes it just seems like one thing, but think if
that’s the only way you’ll want to be able to use or sort that
data.</li>
<li>
<strong>Leave the raw data raw</strong> - don’t mess with it!</li>
<li>Export the cleaned data to a <strong>text based format</strong> like
CSV. This ensures that anyone can use the data, and is the format
required by most data repositories.</li>
</ol>
<p>For instance, we have data from attendance and instruction for
previous research data management workshops. Different people have
entered data into a single spreadsheet. They keep track of things like
date, number of attendees, and who delivered the workshop.</p>
<p>If they were to keep track of the data like this:</p>
<figure><img src="../fig/multiple-info.png" alt="multiple-info example" class="figure mx-auto d-block"></figure><p>the problem is that the number of attendees of different types
(post-graduate researcher (PGR), post-doctoral research associate
(PDRA), and other) are in the same field. So if they wanted to look at
attendance by post-graduate researchers, it would be hard to set up the
data to do this. If instead we put attendee categories in different
columns, you can see that it would be much easier.</p>
</div>
<div class="section level3">
<h3 id="columns-for-variables-and-rows-for-observations">Columns for variables and rows for observations<a class="anchor" aria-label="anchor" href="#columns-for-variables-and-rows-for-observations"></a>
</h3>
<p>The rule of thumb, when setting up a datasheet, is <strong>columns =
variables</strong>, <strong>rows = observations</strong>, <strong>cells
= data</strong> (values).</p>
<p>So, instead we should have:</p>
<figure><img src="../fig/single-info.png" alt="single-info example" class="figure mx-auto d-block"></figure><div id="exercise" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>We’re going to take a messy version of some library training data and
clean it up.</p>
<ol style="list-style-type: decimal">
<li>First <a href="../data/training_attendance.xlsx">download the
data</a>
</li>
<li>Open up the data in a spreadsheet program.</li>
<li>You can see that there are three tabs. Various people have recorded
training attendance statistics over 2016 and 2017, and they have kept
track of the data in their own way. Now you’re being asked to evaluate
the training programme and you want to be able to start doing statistics
with the data.</li>
<li>With the person next to you, work on the messy data so that a
computer will be able to understand it. Clean up the 2016 and 2017 tabs,
and put them all together in one spreadsheet.</li>
<li>After you go through this exercise, we’ll discuss as a group what
you think was wrong with this data and how you fixed it.</li>
</ol>
</div>
</div>
</div>
<div id="important" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="important" class="callout-inner">
<h3 class="callout-title">Important</h3>
<div class="callout-content">
<p>Do not forget of our first piece of advice: <strong>create a new
file</strong> for the cleaned data, and <strong>never modify the
original (raw) data</strong>.</p>
</div>
</div>
</div>
<p>An excellent reference, in particular with regard to R scripting
is</p>
<div id="resource" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="resource" class="callout-inner">
<h3 class="callout-title">Resource</h3>
<div class="callout-content">
<p>Hadley Wickham, <em>Tidy Data</em>, Vol. 59, Issue 10, Sep 2014,
Journal of Statistical Software. <a href="https://www.jstatsoft.org/v59/i10" class="external-link">http://www.jstatsoft.org/v59/i10</a>.</p>
</div>
</div>
</div>
<!-- *Instructors see notes in 'instructors_notes.md' on this exercise.* -->
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use one column for one variable</li>
<li>Use one row for one observation</li>
<li>Use one cell for one value</li>
<li>Never modify your raw data. Always make a copy before making any
changes.</li>
<li>Keep all of the steps you take to clean your data in a plain text
file.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-02-common-mistakes"><p>Content from <a href="02-common-mistakes.html">Formatting problems</a></p>
<hr>
<p>Last updated on 2023-06-24 |

        <a href="https://github.com/librarycarpentry/lc-spreadsheets/edit/main/episodes/02-common-mistakes.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What common mistakes are made when formatting spreadsheets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Recognize and resolve common spreadsheet formatting problems.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>
  This lesson is for reference
  </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<ul>
<li>
<strong>Don’t go through this chapter</strong> except to refer to as
responses to the exercise in the previous chapter.</li>
</ul>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="common-spreadsheet-errors">Common Spreadsheet Errors<a class="anchor" aria-label="anchor" href="#common-spreadsheet-errors"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="#tables">Multiple tables</a></li>
<li><a href="#tabs">Multiple tabs</a></li>
<li><a href="#zeros">Not filling in zeros</a></li>
<li><a href="#null">Using bad null values</a></li>
<li><a href="#formatting">Using formatting to convey
information</a></li>
<li><a href="#formatting-pretty">Using formatting to make the data sheet
look pretty</a></li>
<li><a href="#units">Placing comments or units in cells</a></li>
<li><a href="#info">More than one piece of information in a
cell</a></li>
<li><a href="#field-name">Field name problems</a></li>
<li><a href="#special">Special characters in data</a></li>
<li><a href="#metadata">Inclusion of metadata in data table</a></li>
<li><a href="03-dates-as-data.html">Date formatting</a></li>
</ul>
<hr></section><section><h2 class="section-heading" id="tables">Multiple tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h2>
<hr class="half-width">
<p>A common strategy is creating multiple data tables within one
spreadsheet. <strong>This confuses the computer, so don’t do
this!</strong> When you create multiple tables within one spreadsheet,
you’re drawing false associations between things for the computer, which
sees each row as an observation. You’re also potentially using the same
field name in multiple places, which will make it harder to clean your
data up into a usable form. The example below depicts the problem:</p>
<figure><img src="../fig/2_Multiple_Tables.png" alt="Screengrab of spreadsheet showing formatting errors - multiple tables in one sheet" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="tabs">Multiple tabs<a class="anchor" aria-label="anchor" href="#tabs"></a>
</h2>
<hr class="half-width">
<p>But what about worksheet tabs? That seems like an easy way to
organize data, right? Well, yes and no. When you create extra tabs, you
fail to allow the computer to see connections in the data that are there
(you have to introduce spreadsheet application-specific functions or
scripting to ensure this connection). Say, for instance, you make a
separate tab for each year.</p>
<p>This is bad practice for two reasons: <strong>1)</strong> you are
more likely to accidentally add inconsistencies to your data if each
time you take a measurement, you start recording data in a new tab, and
<strong>2)</strong> even if you manage to prevent all inconsistencies
from creeping in, you will add an extra step for yourself before you
analyze the data because you will have to combine these data into a
single datatable. You will have to explicitly tell the computer how to
combine tabs - and if the tabs are inconsistently formatted, you might
even have to do it by hand!</p>
<p>The next time you’re entering data, and you go to create another tab
or table, I want you to ask yourself “Self, could I avoid adding this
tab by adding another column to my original spreadsheet?”</p>
<p>Your data sheet might get very long over the course of recording
data. This makes it harder to enter data if you can’t see your headers
at the top of the spreadsheet. But do NOT repeat headers. These can
easily get mixed into the data, leading to problems down the road.</p>
<p>Instead you can Freeze the column headers.</p>
<p><a href="https://support.office.com/en-ca/article/Freeze-column-headings-for-easy-scrolling-57ccce0c-cf85-4725-9579-c5d13106ca6a" class="external-link">Documentation
on how to freeze column headers in Microsoft Excel</a></p>
<p><a href="https://help.libreoffice.org/Calc/Freezing_Rows_or_Columns_as_Headers" class="external-link">Documentation
on how to freeze column headers in LibreOffice Calc</a></p>
<p><a href="https://support.google.com/docs/answer/9060449?co=GENIE.Platform%3DDesktop&amp;hl=en" class="external-link">Documentation
on how to freeze column headers in Google Sheets</a></p>
</section><section><h2 class="section-heading" id="zeros">Not filling in zeroes<a class="anchor" aria-label="anchor" href="#zeros"></a>
</h2>
<hr class="half-width">
<p>It might be that when you’re measuring something, it’s usually a
zero, say the number of participants at a training event. Why bother
writing in the number zero in that column, when it’s mostly zeros?</p>
<p>However, there’s a difference between a zero and a blank cell in a
spreadsheet. To the computer, a zero is actually data. You measured or
counted it. A blank cell means that it wasn’t measured and the computer
will interpret it as a null value.</p>
<p>The spreadsheets or statistical programs will likely mis-interpret
blank cells that are meant to be zero. This is equivalent to leaving out
data. Zero observations are real data! Leaving zero data blank is not
good in a written format, but NEVER okay when you move your data into a
digital format.</p>
</section><section><h2 class="section-heading" id="null">Using bad null values<a class="anchor" aria-label="anchor" href="#null"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: using -999, other numerical values, zero,
or text to represent missing values. Whatever the reason, it’s a problem
if unknown or missing data is recorded as -999, 999, or 0. Many
statistical programs will not recognize that these are intended to
represent missing (null) values. How these values are interpreted will
depend on the software you use to analyze your data.</p>
<p><strong>Solution</strong>: A solution will depend on the final
application of your data and how you intend to analyse it, but it is
essential to use a clearly defined and CONSISTENT null indicator. Blank
cells are the best choices for most applications; when working in R,
<code>NA</code> may be an acceptable null value choice.</p>
<p>There are many reasons that null values may be represented
differently within a dataset. Sometimes confusing null values are
automatically recorded from the measuring device. In that case, there’s
not much you can do, but such inconsistencies can often be addressed in
data cleaning with a tool like <a href="https://librarycarpentry.org/lc-open-refine/" class="external-link">OpenRefine</a>
before using or sharing the data. In other cases, null values may convey
different reasons why the data is missing. It may be useful to capture
these reasons, but if you use the same column it is effectively storing
two pieces of information in one column. In such a case, it would be
good to create a new column like <code>data_missing</code>, then to use
that column to capture the reasons for missing data.</p>
<table class="table">
<colgroup>
<col width="5%">
<col width="78%">
<col width="9%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th>Null Values</th>
<th>Problems</th>
<th>Compatibility</th>
<th>Recommendation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>Indistinguishable from a true zero</td>
<td></td>
<td>NEVER use</td>
</tr>
<tr class="even">
<td>Blank</td>
<td>Hard to distinguish values that are missing from those overlooked on
entry. Hard to distinguish blanks from spaces, which behave
differently.</td>
<td>R, Python, SQL, Excel</td>
<td>Best option</td>
</tr>
<tr class="odd">
<td>-999, 999</td>
<td>Not recognized as null by many programs without user input. Can be
inadvertently entered into calculations.</td>
<td></td>
<td>Avoid</td>
</tr>
<tr class="even">
<td>NA, na</td>
<td>Can also be an abbreviation (e.g., North America), can cause
problems with data type (turn a numerical column into a text column). NA
is more commonly recognized than na.</td>
<td>R</td>
<td>Good option</td>
</tr>
<tr class="odd">
<td>N/A</td>
<td>An alternate form of NA, but often not compatible with
software.</td>
<td></td>
<td>Avoid</td>
</tr>
<tr class="even">
<td>NULL</td>
<td>Can cause problems with data type.</td>
<td>SQL</td>
<td>Good option</td>
</tr>
<tr class="odd">
<td>None</td>
<td>Uncommon. Can cause problems with data type.</td>
<td>Python</td>
<td>Avoid</td>
</tr>
<tr class="even">
<td>No data</td>
<td>Uncommon. Can cause problems with data type, contains a space.</td>
<td></td>
<td>Avoid</td>
</tr>
<tr class="odd">
<td>Missing</td>
<td>Uncommon. Can cause problems with data type.</td>
<td></td>
<td>Avoid</td>
</tr>
<tr class="even">
<td>-, +, .</td>
<td>Uncommon. Can cause problems with data type.</td>
<td></td>
<td>Avoid</td>
</tr>
</tbody>
</table>
<p>Choices for representing null values, as illustrated in the table
above, are proposed and explained further by White and others in their
article: <a href="https://ojs.library.queensu.ca/index.php/IEE/article/view/4608" class="external-link">Nine
simple ways to make it easier to (re)use your data.</a> <em>Ideas in
Ecology and Evolution</em> 6 (2013): 1-10. DOI: <a href="https://10.4033/iee.2013.6b.6.f" class="external-link">10.4033/iee.2013.6b.6.f</a></p>
</section><section><h2 class="section-heading" id="formatting">Using formatting to convey information<a class="anchor" aria-label="anchor" href="#formatting"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: highlighting cells, rows or columns that
should be excluded from an analysis, leaving blank rows to indicate
separations in data.</p>
<figure><img src="../fig/formatting.png" alt="formatting" class="figure mx-auto d-block"></figure><p><strong>Solution</strong>: create a new field to encode which data
should be excluded.</p>
<figure><img src="../fig/good_formatting.png" alt="good formatting" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="formatting-pretty">Using formatting to make the data sheet look pretty<a class="anchor" aria-label="anchor" href="#formatting-pretty"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: merging cells.</p>
<p><strong>Solution</strong>: If you’re not careful, formatting a
worksheet to be more aesthetically pleasing can compromise your
computer’s ability to see associations in the data. Merged cells are an
absolute formatting NO-NO if you want to make your data readable by
statistics software. Consider restructuring your data in such a way that
you will not need to merge cells to organize your data.</p>
</section><section><h2 class="section-heading" id="units">Placing comments or units in cells<a class="anchor" aria-label="anchor" href="#units"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: Your data was collected, in part, by a
summer student who you later found out was mis-recording the duration of
training sessions, some of the time. You want a way to note these data
are suspect.</p>
<p><strong>Solution</strong>: Most statistical programs can’t see
Excel’s comments, and would be confused by comments placed within your
data cells. As described above for formatting, create another field if
you need to add notes to cells. Similarly, don’t include units in cells
(such as “hours”,“min”): ideally, all the units or measurements you
place in one column should be of the same standard, but if for some
reason they aren’t, insert another column and specify the units.</p>
</section><section><h2 class="section-heading" id="info">More than one piece of information in a cell<a class="anchor" aria-label="anchor" href="#info"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: One table recorded attendance by the
different types of attendees. This table recorded number of attendees of
different types: post-graduate researcher (PGR), post-doctoral research
associate (PDRA), and other.</p>
<p><strong>Solution</strong>: Never include more than one piece of
information in a cell. Design your data sheet to include a column for
each type of attendee, if this information is important to collect,
rather than just a total number.</p>
</section><section><h2 class="section-heading" id="field-name">Field name problems<a class="anchor" aria-label="anchor" href="#field-name"></a>
</h2>
<hr class="half-width">
<p>Choose descriptive field names, but be careful not to include:
spaces, numbers, or special characters of any kind. Spaces can be
misinterpreted by parsers that use whitespace as delimiters and some
programs don’t like field names that are text strings that start with
numbers. Underscores (<code>_</code>) are a good alternative to spaces
and consider writing names in camel-case to improve readability.
Remember that abbreviations that make sense at the moment may not be so
obvious in 6 months but don’t overdo it with names that are excessively
long. Including the units in the field names avoids confusion and
enables others to readily interpret your fields.</p>
<p><strong>Examples</strong></p>
<table class="table">
<thead><tr class="header">
<th>Good Name</th>
<th>Good Alternative</th>
<th>Avoid</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Max_temp_C</td>
<td>MaxTemp</td>
<td>Maximum Temp (°C)</td>
</tr>
<tr class="even">
<td>Precipitation_mm</td>
<td>Precipitation</td>
<td>precmm</td>
</tr>
<tr class="odd">
<td>Mean_year_growth</td>
<td>MeanYearGrowth</td>
<td>Mean growth/year</td>
</tr>
<tr class="even">
<td>sex</td>
<td>sex</td>
<td>M/F</td>
</tr>
<tr class="odd">
<td>length</td>
<td>length</td>
<td>l</td>
</tr>
<tr class="even">
<td>cell_type</td>
<td>CellType</td>
<td>Cell Type</td>
</tr>
<tr class="odd">
<td>Observation_01</td>
<td>first_observation</td>
<td>1st Obs</td>
</tr>
</tbody>
</table></section><section><h2 class="section-heading" id="special">Special characters in data<a class="anchor" aria-label="anchor" href="#special"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: You treat Excel as a word processor when
writing notes, even copying data directly from Word or other
applications.</p>
<p><strong>Solution</strong>: This is a common strategy. For example,
when writing longer text in a cell, people often include line breaks,
em-dashes, et al in their spreadsheet. Worse yet, when copying data in
from applications such as Word, formatting and fancy non-standard
characters (such as left- and right-aligned quotation marks) are
included. When exporting this data into a coding/statistical environment
or into a relational database, dangerous things may occur, such as lines
being cut in half and encoding errors being thrown.</p>
<p>General best practice is to avoid adding characters such as newlines,
tabs, and vertical tabs. In other words, treat a text cell as if it were
a simple web form that can only contain text and spaces.</p>
</section><section><h2 class="section-heading" id="metadata">Inclusion of metadata in data table<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: You add a legend at the top or bottom of
your data table explaining column meaning, units, exceptions, etc.</p>
<p><strong>Solution</strong>: While recording data about your data
(“metadata”) is essential, this information should not be contained in
the data file itself. Unlike a table in a paper or a supplemental file,
metadata (in the form of legends) should not be included in a data file
since this information is not data, and including it can disrupt how
computer programs interpret your data file. Rather, metadata should be
stored as a separate file in the same directory as your data file,
preferably in plain text format with a name that clearly associates it
with your data file. Because metadata files are free text format, they
also allow you to encode comments, units, information about how null
values are encoded, etc. that are important to document but can disrupt
the formatting of your data file.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Don’t use multiple tables in one sheet</li>
<li>Don’t use multiple tabs in a file</li>
<li>Fill in zero when you mean zero</li>
<li>Use an appropriate null value to record missing data</li>
<li>Don’t use formatting to convey information or make the spreadsheet
look pretty</li>
<li>Don’t put units or comments in cells</li>
<li>Don’t combine several values in one cell</li>
<li>Take care over column names</li>
<li>Avoid including special characters in your data file</li>
<li>Put metadata (units, legends etc.) in a separate file</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-03-dates-as-data"><p>Content from <a href="03-dates-as-data.html">Dates as data</a></p>
<hr>
<p>Last updated on 2023-06-25 |

        <a href="https://github.com/librarycarpentry/lc-spreadsheets/edit/main/episodes/03-dates-as-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How are dates handled by computers?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe how dates are stored and formatted in spreadsheets.</li>
<li>Describe the advantages of alternative date formatting in
spreadsheets.</li>
<li>Demonstrate best practices for entering dates in spreadsheets.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Narrative Guidance </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<ul>
<li>Do the exercise and make the point about dates either in response to
a learner bringing up date as an issue during the responses, or at the
end of the response time.</li>
</ul>
</div>
</div>
</div>
</div>
<p>Dates in spreadsheets are often stored in one column. Whilst this
seems the most natural way to enter dates, it actually is not a good
practice. A spreadsheet application may display the dates correctly (for
readability) but how it actually handles and stores the dates may be
problematic. This can cause problems if the date displayed does not
fully represent the information that the spreadsheet application is
using, such as when the year is not displayed; in addition, date
information may be changed when data is converted to different
spreadsheet formats, such as between <code>.xlsx</code> and
<code>.csv</code>, or opened in different applications.</p>
<section><h2 class="section-heading" id="date-formats-in-spreadsheets">Date formats in spreadsheets<a class="anchor" aria-label="anchor" href="#date-formats-in-spreadsheets"></a>
</h2>
<hr class="half-width">
<p>Spreadsheet applications employ numerous features that facilitate the
processing and display of date information. While these features often
make date information more easily readable, the underlying data handling
techniques can create data ambiguity in a variety of ways. The figure
below illustrates some of the ways that the display of information
representing the same date can vary. Column A is the information as
entered by a user, and the following columns show different ways that
the information may be displayed.</p>
<figure><img src="../fig/5_excel_dates_1.jpg" alt="Many formats, many ambiguities" class="figure mx-auto d-block"></figure><div id="how-can-these-features-create-data-ambiguity" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="how-can-these-features-create-data-ambiguity" class="callout-inner">
<h3 class="callout-title">How can these features create data ambiguity?</h3>
<div class="callout-content">
<p>Ideally, data should be as unambiguous as possible.</p>
<ul>
<li>What do you notice about the display of the date information above?
What information changes between the columns?</li>
<li>What aspects of the display lack specificity and may introduce
ambiguity?</li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="displaying-dates">Displaying dates<a class="anchor" aria-label="anchor" href="#displaying-dates"></a>
</h3>
<p>The figure above shows that ambiguity may creep into your data in
numerous ways depending on the format you chose when you entered your
data. If you’re not fully aware of these ambiguities, you may find that
Excel will interpret your data in unexpected ways later.</p>
<p>The display format of each cell can be modified. To change the
display in Excel, navigate to the Format menu and choose “Cells…”. In
the “Format Cells” dialog box, you can select a Date format and choose
various display outputs (some are shown in the above figure). In the
dialog box, you can also choose to format the cell as a number or text.
It may be useful to format the cell as one of these other datatypes,
since as we will discuss next, the spreadsheet program understands the
date information as a number.</p>
</div>
<div class="section level3">
<h3 id="storing-dates">Storing dates<a class="anchor" aria-label="anchor" href="#storing-dates"></a>
</h3>
<p>Spreadsheet applications, including Excel, <strong>store dates as a
number</strong> (see Column I in the figure above). The application
developers chose a single day to designate as day zero, and each
subsequent day is incremented by a value of one. Essentially, Excel
counts the days from a default of December 31, 1899. Thus, July 2, 2014
is stored as the serial number <code>41822</code> because it is 41,822
days after day zero. Not all applications or operating systems use the
same date for day zero.</p>
<p>Understanding the spreadsheet program uses serial numbers to process
dates can be useful in some circumstances. Using the above functions,
you can easily add days, months or years to a given date. Say you had a
sampling plan where you needed to sample every thirty seven days. In
another cell, you could input the following:</p>
<pre class="source"><code>=B2+37</code></pre>
<p>This would display:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">8</span><span class="op">-</span><span class="va">Aug</span></span></code></pre>
</div>
<p>This happens because Excel processes the date July 2, 2014 as the
number <code>41822</code>. Adding <code>41822 + 37</code> results in
<code>41859</code> which Excel interprets as August 8, 2014. The program
retains the format (for the most part) of the cell that is being
operated upon (unless you did some sort of formatting to the cell
before, and then all bets are off). Month and year rollovers are
internally tracked and applied.</p>
<div id="working-with-historical-dates-before-1900" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="working-with-historical-dates-before-1900" class="callout-inner">
<h3 class="callout-title">Working with historical dates (before 1900)</h3>
<div class="callout-content">
<p>Excel is unable to parse dates from before 1899-12-31, and will thus
leave these untouched. If you’re mixing historic data from before and
after this date, Excel will translate only the post-1900 dates into its
internal format, thus resulting in mixed data. If you’re working with
historic data, be extremely careful with your dates!</p>
<p>Excel also entertains a second date system, the 1904 date system, as
the default in Excel for Macintosh. This system will assign a different
serial number than the <a href="https://support.microsoft.com/en-us/help/214330/differences-between-the-1900-and-the-1904-date-system-in-excel" class="external-link">1900
date system</a>. Because of this, <a href="https://uc3.cdlib.org/2014/04/09/abandon-all-hope-ye-who-enter-dates-in-excel/" class="external-link">dates
must be checked for accuracy when exporting data from Excel</a> (look
for dates that are about 4 years off).</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="useful-spreadsheet-functions-for-working-with-date-information">Useful spreadsheet functions for working with date information<a class="anchor" aria-label="anchor" href="#useful-spreadsheet-functions-for-working-with-date-information"></a>
</h2>
<hr class="half-width">
<p>Let’s take a look at some functions that will help us work with date
information in spreadsheet applications. Please remember that
<strong>functions that are valid for a given spreadsheet program (be it
LibreOffice, Microsoft Excel, OpenOffice.org, Gnumeric, etc.) are
usually guaranteed to be compatible only within the same family of
products.</strong> So, if you will later need to export the data and
need to conserve the timestamps you should consider recording date
information using one of the solutions discussed below.</p>
<p>If a date is entered in one column, we can use functions to extract
information from that column into other columns. For example, it can be
useful to display the specific information about the year, month, and
day. Conversely, these functions can convert supplied numerical values
from numbers into dates. Date-related functions allow us to convert date
values from the stored numerical value to a readable display value, make
calculations between date values, and also to extract the date values so
that they do not change as data is transformed or exchanged between new
users and systems.</p>
<p>The table below outlines a few useful date-related functions and how
they differ between some of the widely used spreadsheet
applications.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="74%">
<col width="4%">
<col width="10%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th>Action of function</th>
<th>Excel</th>
<th>LibreOffice</th>
<th>OpenOffice</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Return the year number represented in the referenced cell value</td>
<td><code>YEAR()</code></td>
<td><code>YEAR()</code></td>
<td></td>
</tr>
<tr class="even">
<td>Return the month number represented in the referenced date serial
number</td>
<td><code>MONTH()</code></td>
<td><code>MONTH()</code></td>
<td></td>
</tr>
<tr class="odd">
<td>Return the day of the month represented in the referenced date
serial number</td>
<td><code>DAY()</code></td>
<td><code>DAY()</code></td>
<td></td>
</tr>
<tr class="even">
<td>Calculate and display a date based on supplied year, month, and day
values</td>
<td><code>DATE(Year, Month, Day)</code></td>
<td><code>DATE(Year; Month; Day)</code></td>
<td></td>
</tr>
<tr class="odd">
<td>Return the serial number for date information supplied as a
string</td>
<td><code>DATEVALUE()</code></td>
<td><code>DATEVALUE("Text")</code></td>
<td></td>
</tr>
<tr class="even">
<td>Change display of a number by applying specified formatting</td>
<td><code>TEXT(Value, "Formatting code to apply")</code></td>
<td><code>TEXT(Value; "Formatting to apply")</code></td>
<td></td>
</tr>
<tr class="odd">
<td>Return the current system date</td>
<td><code>NOW()</code></td>
<td><code>NOW()</code></td>
<td></td>
</tr>
</tbody>
</table>
<div id="using-date-related-functions-excel" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="using-date-related-functions-excel" class="callout-inner">
<h3 class="callout-title">Using Date-Related Functions (Excel)</h3>
<div class="callout-content">
<p>Pulling month, day, and year out of dates:</p>
<ul>
<li>In the <code>Dates</code> tab of your Excel file we summarized
training data from 2015. There’s a <code>date</code> column.</li>
<li>Extract month, day and year from the date to three new columns.</li>
</ul>
<p>Tip: Make sure the new column is formatted as a number and not as a
date. Change the function to correspond to each row: i.e., =MONTH(A3),
=DAY(A3), =YEAR(A3) for the next row.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>You can see that even though you wanted the year to be 2015 for all
entries, your spreadsheet program interpreted two entries as 2017, the
year the data was entered, not the year of the workshop. <img src="../fig/3_Dates_as_Columns.png" alt="dates, exersize 1" class="figure"></p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="adding-dates">Adding dates<a class="anchor" aria-label="anchor" href="#adding-dates"></a>
</h3>
<p>Adding years and months and days is slightly trickier because we need
to make sure that we are adding the amount to the correct entity.</p>
<ul>
<li>First we extract the single entities (day, month, or year)</li>
<li>We can then add values to do that</li>
<li>Finally the complete date string is reconstructed using the
<code>DATE()</code> function.</li>
</ul>
<p><strong>Note:</strong> Time values raise similar challenges. Seconds
can be directly added but to add hour and minutes you will need to make
sure that quantities are added to the correct entities.</p>
</div>
</section><section><h2 class="section-heading" id="advantages-of-alternative-date-formatting">Advantages of Alternative Date Formatting<a class="anchor" aria-label="anchor" href="#advantages-of-alternative-date-formatting"></a>
</h2>
<hr class="half-width">
<p>The display ambiguities discussed above can lead to unintended
changes or unknown errors in your data. Exchanging data between
applications or converting data into different formats can also create
unexpected changes. Similar issues also cause challenges for data
interoperability, sharing and reuse, and long-term preservation.
Alternative date formats can help to address these issues, and we will
learn about three below. First, however, let’s explore the challenges
further by seeing what happens to date information when converted
between different formats.</p>
<div id="exchanging-date-information-between-formats" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exchanging-date-information-between-formats" class="callout-inner">
<h3 class="callout-title">Exchanging Date Information between Formats</h3>
<div class="callout-content">
<p>What happens to the dates in the <code>dates</code> tab of our
workbook if we save this sheet in Excel (in <code>csv</code> format) and
then open the file in a plain text editor (like TextEdit or Notepad)?
What happens to the dates if we then open the <code>csv</code> file in
Excel?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ul>
<li>Click to the <code>dates</code> tab of the workbook and double-click
on any of the values in the <code>Date collected</code> column. Notice
that most of the dates display with the year 2015 and two are 2017.</li>
<li>Select <code>File -&gt; Save As</code> in Excel and in the drop down
menu for file format select
<code>CSV UTF-8 (Comma delimited) (.csv)</code>. Click
<code>Save</code>.</li>
<li>You will see a pop-up that says ‘This workbook cannot be saved in
the selected file format because it contains multiple sheets.’ Choose
<code>Save Active Sheet</code>.</li>
<li>Navigate to the file in Finder (Mac) or Explorer (Windows). Right
click and select <code>Open With</code>. Choose a plain text editor
application and view the file. Notice that the dates display as
month/day without any year information.</li>
<li>Now right click on the file again and open with Excel. Notice that
the dates display with the current year, not 2015. As you can see,
exporting data from Excel and then importing it back into Excel
fundamentally changed the data once again!</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="day">Storing dates as YEAR, MONTH, DAY<a class="anchor" aria-label="anchor" href="#day"></a>
</h3>
<p>Storing dates in YEAR, MONTH, DAY format helps remove this ambiguity.
Let’s look at this issue a bit closer.</p>
<p>For instance, in a spreadsheet recording insect counts every few days
in July 2001, the data displayed as shown below in Column A. Note that
the data was recorded in only one cell in each row, and the data only
included reference to the month and day
(<code>&lt;MONTH&gt;-&lt;DAY&gt;</code>).</p>
<figure><img src="../fig/6_excel_dates_2.jpg" alt="So, so ambiguous, it's even confusing Excel" class="figure mx-auto d-block"></figure><p>When interpreted in Excel, it appears that the observations had been
recorded in 2010, 2014, 2015 and 2017 even though our records state that
the data was gathered in 2001.</p>
<p>Entering dates in one cell is helpful but due to the fact that the
spreadsheet programmes may interpret and save the data in different ways
(doing that somewhat behind the scenes), there is a better practice.</p>
<p>In dealing with dates in spreadsheets, we recommend separating
<strong>date data into separate fields</strong> (day, month, year),
which will eliminate any chance of ambiguity.</p>
</div>
<div class="section level3">
<h3 id="doy">Storing dates as YEAR, DAY-OF-YEAR<a class="anchor" aria-label="anchor" href="#doy"></a>
</h3>
<p>There is also another option: You can also store dates as year, and
day of year (DOY). Why? Because depending on your question, this might
be what’s useful to you, and there is practically no possibility for
ambiguity creeping in.</p>
<p>Statistical models often incorporate year as a factor, to account for
year-to-year variation, and DOY can be used to measure the passage of
time within a year.</p>
<p>So, can you convert all your dates into DOY format? Well, in Excel,
here’s a handy dandy guide:</p>
<figure><img src="../fig/7_excel_dates_3.jpg" alt="Kill that ambiguity before it bites you!" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="str">Storing dates and times as a single string<a class="anchor" aria-label="anchor" href="#str"></a>
</h3>
<p>When dealing with dates and times, the best alternative is to convert
the date string into a single string using the
<code>YYYYMMDDhhmmss</code> format, following the international date
standard <a href="https://en.wikipedia.org/wiki/ISO_8601" class="external-link">ISO 8601</a>.
For example the date <code>March 24, 2015 17:25:35</code> would become
<code>20150324172535</code>, where:</p>
<pre><code>YYYY:   the full year, i.e. 2015
MM:     the month, i.e. 03
DD:     the day of month, i.e. 24
hh:     hour of day, i.e. 17
mm:     minutes, i.e. 25
ss:     seconds, i.e. 35</code></pre>
<p>Such strings will be correctly sorted in ascending or descending
order, and by knowing the format they can then be correctly processed by
the receiving software.</p>
</div>
</section><section><h2 class="section-heading" id="preferred-date-format">Preferred date format<a class="anchor" aria-label="anchor" href="#preferred-date-format"></a>
</h2>
<hr class="half-width">
<p>Due to the issues caused by the way that spreadsheet programs handle
and display dates, it is safer to store dates with <a href="#day">YEAR,
MONTH, DAY</a> in separate columns or as <a href="#doy">YEAR and
DAY-OF-YEAR</a> in separate columns. This practice will make your data
less ambiguous, will guard against changes that may be caused if the
spreadsheet is opened by other software, and generally make your data
table more accessible and interoperable.</p>
</section><section><h2 class="section-heading" id="further-resources">Further Resources<a class="anchor" aria-label="anchor" href="#further-resources"></a>
</h2>
<hr class="half-width">
<p>Working with dates and day of year information can be unfamiliar
since it does not match how we typically see dates on a calendar by the
day of a month. These resources provide useful information for
calculating the day of the year:</p>
<ul>
<li>The Earth Systems Research Lab provides this calendar that displays
day of year information for any year you select: <a href="https://www.esrl.noaa.gov/gmd/grad/neubrew/Calendar.jsp" class="external-link">https://www.esrl.noaa.gov/gmd/grad/neubrew/Calendar.jsp</a>.</li>
<li>The U.S. National Snow and Ice Data Center provides a useful chart
to calculate the day of year: <a href="https://nsidc.org/support/faq/day-year-doy-calendar" class="external-link">https://nsidc.org/support/faq/day-year-doy-calendar</a>.</li>
</ul>
<p>Most spreadsheet applications offer more detailed information about
working with date and time information. Some of these are referenced
below:</p>
<ul>
<li>Microsoft Excel <a href="https://support.microsoft.com/en-us/office/date-and-time-functions-reference-fd1b5961-c1ae-4677-be58-074152f97b81" class="external-link">date
and time functions reference</a>.</li>
<li>LibreOffice Date &amp; Time Functions Reference <a href="https://help.libreoffice.org/6.2/en-US/text/scalc/01/04060102.html" class="external-link">v.
6.2</a>.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Excel is notoriously bad at handling dates.</li>
<li>Treating dates as multiple pieces of data rather than one makes them
easier to handle and exchange between programs.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-04-quality-control"><p>Content from <a href="04-quality-control.html">Basic quality assurance and control</a></p>
<hr>
<p>Last updated on 2023-06-24 |

        <a href="https://github.com/librarycarpentry/lc-spreadsheets/edit/main/episodes/04-quality-control.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can you keep data entry clean?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Apply quality assurance techniques to limit incorrect data
entry.</li>
<li>Apply quality control techniques to identify errors in
spreadsheets.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Narrative Guidance </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p><em>This lesson is optional</em></p>
<p>The challenge with this lesson is that the instructor’s version of
the spreadsheet software is going to look different than about half the
room’s. It makes it challenging to show where you can find menu options
and navigate through.</p>
<p>Instead discuss the concepts of quality control, and how things like
sorting can help you find outliers in your data.</p>
</div>
</div>
</div>
</div>
<p>When you have a well-structured data table, you can use several
simple techniques within your spreadsheet to ensure the data you enter
is free of errors. These approaches include techniques that are
implemented <strong>prior to entering data</strong> (<strong>quality
assurance</strong>) and techniques that are used <strong>after entering
data to check for errors</strong> (<strong>quality
control</strong>).</p>
<section><h2 class="section-heading" id="quality-assurance">Quality Assurance<a class="anchor" aria-label="anchor" href="#quality-assurance"></a>
</h2>
<hr class="half-width">
<p>Quality assurance stops bad data from ever being entered by checking
to see if values are valid during data entry. For example, if research
is being conducted at sites A, B, and C, then the value V (which is
right next to B on the keyboard) should never be entered. Likewise if
one of the kinds of data being collected is a count, only integers
greater than or equal to zero should be allowed.</p>
<p>To control the kind of data entered into a a spreadsheet we use Data
Validation (Excel) or Validity (LibreOffice Calc), to set the values
that can be entered in each data column.</p>
<ol style="list-style-type: decimal">
<li><p>Select the cells or column you want to validate</p></li>
<li><p>On the <code>Data</code> tab select
<code>Data Validation</code></p></li>
</ol>
<figure><img src="../fig/data_validation.png" alt="Image of Data Validation button on Data tab" class="figure mx-auto d-block"></figure><ol start="3" style="list-style-type: decimal">
<li>In the <code>Allow</code> box select the kind of data that should be
in the column. Options include whole numbers, decimals, lists of items,
dates, and other values.</li>
</ol>
<figure><img src="../fig/data_validation_window.png" alt="Image of Data Validation window" class="figure mx-auto d-block"></figure><ol start="4" style="list-style-type: decimal">
<li>After selecting an item enter any additional details. For example if
you’ve chosen a list of values then enter a comma-delimited list of
allowable values in the <code>Source</code> box.</li>
</ol>
<p>We can’t have half a person attending a workshop, so let’s try this
out by setting the <code>num_registered</code> column in our spreadsheet
to only allow whole numbers between 1 and 100.</p>
<ol style="list-style-type: decimal">
<li>Select the <code>num_registered</code> column</li>
<li>On the <code>Data</code> tab select
<code>Data Validation</code>
</li>
<li>In the <code>Allow</code> box select <code>Whole number</code>
</li>
<li>Set the minimum and maximum values to 1 and 100.</li>
</ol>
<figure><img src="../fig/4_data-validation-whole-num.png" alt="Image of Data Validation window for validating plot values" class="figure mx-auto d-block"></figure><p>Now let’s try entering a new value in the <code>num_registered</code>
column that isn’t a valid class size. The spreadsheet stops us from
entering the wrong value and asks us if we would like to try again.</p>
<figure><img src="../fig/4_data-validation-alert.png" alt="Image of error when trying to enter invalid data" class="figure mx-auto d-block"></figure><p>You can customize the resulting message to be more informative by
entering your own message in the <code>Error Alert</code> tab, and you
can edit the <code>Style</code> for when a non-valid value is entered,
by not allowing other values or just give a warning about non valid
entries.</p>
<figure><img src="../fig/4_data-validation-error-msg.png" alt="Image of Error Alert tab" class="figure mx-auto d-block"></figure><p>to display a (pop up) message about the correct values for a column
with Data Validation set, use the <code>Input Message</code> tab.</p>
<figure><img src="../fig/4_data-validation-input-message.png" alt="Image of Input Message tab" class="figure mx-auto d-block"></figure><p>Quality assurance can make data entry easier as well as more robust.
For example, if you use a list of options to restrict data entry, the
spreadsheet will provide you with a drop-downlist of the available
items. So, instead of trying to remember the workshop title
abbreviation, you can just select the right option from the list.</p>
<figure><img src="../fig/4_data-validation-auto-complete.png" alt="Image of drop-down menu" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="quality-control">Quality Control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h2>
<hr class="half-width">
<div id="tip" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip!</h3>
<div class="callout-content">
<p>Before doing any quality control operations, save your original file
with the formulas and a name indicating it is the original data. Create
a <strong>separate file</strong> with appropriate naming and versioning,
and ensure your data is stored as <strong>values</strong> and not as
<strong>formulas</strong>. Because formulas refer to other cells, and
you may be moving cells around, you may compromise the integrity of your
data if you do not take this step!</p>
</div>
</div>
</div>
<p><strong>readme (README) files:</strong> As you start manipulating
your data files, create a readme document / text file to keep track of
your files and document your manipulations so that they may be easily
understood and replicated, either by your future self or by an
independent researcher. Your readme file should document all of the
files in your data set (including documentation), describe their content
and format, and lay out the organizing principles of folders and
subfolders. For each of the separate files listed, it is a good idea to
document the manipulations or analyses that were carried out on those
data. <a href="https://data.research.cornell.edu/content/readme" class="external-link">Cornell
University’s Research Data Management Service Group</a> provides
detailed guidelines for how to write a good readMe file, along with an
adaptable template.</p>
<div class="section level3">
<h3 id="sorting">Sorting<a class="anchor" aria-label="anchor" href="#sorting"></a>
</h3>
<p><strong>Bad values often sort to bottom or top of the
column</strong>. For example, if your data should be numeric, then
alphabetical and null data will group at the ends of the sorted data.
Sort your data by each field, one at a time. Scan through each column,
but pay the most attention to the top and the bottom of a column. If
your dataset is well-structured and does not contain formulas, sorting
should never affect the integrity of your dataset.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Let’s try this with the <em>Dates</em> tab in our messy spreadsheet.
Go to that tab. Select <strong>Data</strong> then select
<strong>Sort</strong></p>
<p>Sort by <code>len_hours</code> in the order <em>Largest to
Smallest</em></p>
<ul>
<li><p>When you do this sort, do you notice anything strange?</p></li>
<li><p>Try sorting by other columns. Anything strange there?</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Click the <kbd>Sort</kbd> button on the <kbd>Data</kbd> tab in Excel.
A pop-up will appear.</p>
<p>The following window will display, choose the column you want to sort
as well as the sort order.</p>
<figure><img src="../fig/4-sort-len_hours.png" alt="Figure of Sorting menu" class="figure mx-auto d-block"></figure><p>Note how the odd values sort to the top. The cells containing “min”
or “hour” are found towards the top. Larger values like 90, 60 and 15
also are sorted so you can evaluate them. This is a powerful way to
check your data for outliers and odd values. <img src="../fig/4-sorted-len_hours.png" alt="Sorted data" class="figure"></p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="conditional-formatting">Conditional formatting<a class="anchor" aria-label="anchor" href="#conditional-formatting"></a>
</h3>
<p>Use with caution! But a great way to flag inconsistent values when
entering data.</p>
<p>Conditional formatting basically can do something like color code
your values by some criteria or from lowest to highest. This makes it
easy to scan your data for outliers. It is nice to be able to do these
scans in spreadsheets, but we also can do these checks in a programming
language like Python or R, or in OpenRefine or SQL.</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Make sure the <code>num_attended</code> column is highlighted.</li>
<li>Go to <strong>Format</strong> then <strong>Conditional
Formatting</strong>.</li>
<li>Apply any 2-Color Scale formatting rule.</li>
<li>Now we can scan through and different colors will stand out. Do you
notice any strange values?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>We can now quickly see the two outlier cells with the value of
<code>0</code> and can also see that these two classes were
canceled.</p>
<figure><img src="../fig/4_conditional-formatting.png" class="output figure mx-auto d-block" alt="Conditional Formatting"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use data validation tools to minimise the possibility of input
errors.</li>
<li>Use sorting and conditional formatting to identify possible
errors.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-05-exporting-data"><p>Content from <a href="05-exporting-data.html">Exporting data from spreadsheets</a></p>
<hr>
<p>Last updated on 2023-06-24 |

        <a href="https://github.com/librarycarpentry/lc-spreadsheets/edit/main/episodes/05-exporting-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What problems are there with Excel files?</li>
<li>How can we share data from spreadsheets that is useful for a variety
of applications?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Store spreadsheet data in universal file formats.</li>
<li>Export data from a spreadsheet to a .csv file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>
  Narrative Guidance
  </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<ul>
<li>Have the students export their cleaned data as <code>.csv</code>.
Reiterate again the need for data in this format for the other tools
we’ll be using.</li>
</ul>
</div>
</div>
</div>
</div>
<p>For various reasons, it is not a good idea to store the data you’re
going to work with for your analyses in Excel file formats
(<code>*.xls</code> or <code>*.xlsx</code> - depending on the Excel
version) if you are hoping to preserve the data for the long term.
Why?</p>
<ul>
<li>
<p>For one thing, Excel is a <strong>proprietary format</strong>,
and it is possible that in the future, technology won’t exist (or will
become sufficiently rare) to make it inconvenient, if not impossible, to
open the file.</p>
<p>Think about zipdisks. How many old theses in your lab are “backed up”
and stored on zipdisks? Ever wanted to pull out the raw data from one of
those? <em>Exactly.</em></p>
</li>
<li><p><strong>Other spreadsheet software</strong> may not be able to
open files saved in a proprietary Excel format.</p></li>
<li><p><strong>Different versions of Excel</strong> may handle data
differently, leading to inconsistencies.</p></li>
</ul>
<p>As an example, do you remember how we talked about how Excel stores
<strong>dates</strong> earlier? Turns out there are <strong>multiple
defaults for different versions of the software</strong>. And you can
switch between them all willy-nilly. So, say you’re compiling
Excel-stored data from multiple sources. There’s dates in each file-
Excel interprets them as their own internally consistent serial numbers.
When you combine the data, Excel will take the serial number from the
place you’re importing it from, and interpret it using the rule set for
the version of Excel you’re using. Essentially, you could be adding a
huge error to your data, and it wouldn’t necessarily be flagged by any
data cleaning methods if your ranges overlap.</p>
<p>Storing data in a <strong>universal</strong>, <strong>open</strong>,
<strong>static format</strong> will help deal with this problem. Try
<strong>tab-delimited</strong> or <strong>CSV</strong> (more common).
CSV files are plain text files where the columns are separated by
commas, hence ‘comma separated variables’ or CSV. The advantage of a CSV
over an Excel/SPSS/etc. file is that we can open and read a CSV file
using just about any software, including a simple <strong>text
editor</strong>. Data in a CSV can also be <strong>easily
imported</strong> into other formats and environments, such as SQLite
and R. We’re not tied to a certain version of a certain expensive
program when we work with CSV, so it’s a good format to work with for
maximum portability and endurance. Most spreadsheet programs can save to
delimited text formats like CSV easily, although they complain and make
you feel like you’re doing something wrong along the way.</p>
<p>To save a file you have opened in Excel in <code>*.csv</code>
format:</p>
<ol style="list-style-type: decimal">
<li>From the top menu select ‘File’ and ‘Save as’.</li>
<li>In the ‘Format’ field, from the list, select ‘Comma Separated
Values’ (<code>*.csv</code>).</li>
<li>Double check the file name and the location where you want to save
it and hit ‘Save’.</li>
</ol>
<figure><img src="../fig/excel-to-csv.png" alt="Saving an Excel file to CSV" class="figure mx-auto d-block"></figure><p>An important note for backwards compatibility: you can open CSVs in
Excel!</p>
<section><h2 class="section-heading" id="a-note-on-cross-platform-operability">A Note on Cross-platform Operability<a class="anchor" aria-label="anchor" href="#a-note-on-cross-platform-operability"></a>
</h2>
<hr class="half-width">
<p>By default, most coding and statistical environments expect
UNIX-style line endings (ASCII <code>LF</code> character) as
representing line breaks. However, Windows uses an alternate line ending
signifier (ASCII <code>CR LF</code> characters) by default for legacy
compatibility with Teletype-based systems..</p>
<p>As such, when exporting to CSV using Excel, your data in text format
will look like this:</p>
<pre><code>data1,data2&lt;CR&gt;&lt;LF&gt;1,2&lt;CR&gt;&lt;LF&gt;4,5&lt;CR&gt;&lt;LF&gt;</code></pre>
<p>When opening your CSV file in Excel again, it will parse it as
follows:</p>
<figure><img src="../fig/NewLine_example.png" alt="CR LF" class="figure mx-auto d-block"></figure><p>However, if you open your CSV file on a different system that does
not parse the <code>CR</code> character it will interpret your CSV file
differently:</p>
<p>Your data in text format then look like this:</p>
<pre><code>data1,data2&lt;CR&gt;
1,2&lt;CR&gt;
…</code></pre>
<p>You will then see a weird character or possibly the string
<code>CR</code> or <code>\r</code>:</p>
<figure><img src="../fig/NewLine_example2.png" alt="no CR LF" class="figure mx-auto d-block"></figure><p>thus causing terrible things to happen to your data. For example,
<code>2\r</code> is not a valid integer, and thus will throw an error
(if you’re lucky) when you attempt to operate on it in R or Python. Note
that this happens on Excel for macOS as well as Windows, due to legacy
Windows compatibility.</p>
<p>There are a handful of solutions for enforcing uniform UNIX-style
line endings on your exported CSVs:</p>
<ol style="list-style-type: decimal">
<li><p>When exporting from Excel, save as a “Windows comma separated
(.csv)” file</p></li>
<li><p>If you store your data file under version control (which you
should be doing!) using Git, edit the <code>.git/config</code> file in
your repository to automatically translate <code>\r\n</code> line
endings into <code>\n</code>. Add the following to the file (<a href="https://nicercode.github.io/blog/2013-04-30-excel-and-line-endings" class="external-link">see
the detailed tutorial</a>):</p></li>
</ol>
<pre><code>[filter "cr"]
clean = LC_CTYPE=C awk '{printf(\"%s\\n\", $0)}' | LC_CTYPE=C tr '\\r' '\\n'
smudge = tr '\\n' '\\r'`</code></pre>
<p>and then create a file <code>.gitattributes</code> that contains the
line:</p>
<pre><code>*.csv filter=cr</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Use <a href="https://dos2unix.sourceforge.net/" class="external-link">dos2unix</a>
(available on OSX, *nix, and Cygwin) on local files to standardize line
endings.</li>
</ol>
<div class="section level4">
<h4 id="a-note-on-python-and-xls">A note on Python and <code>xls</code>
<a class="anchor" aria-label="anchor" href="#a-note-on-python-and-xls"></a>
</h4>
<p>There are Python packages that can read <code>xls</code> files (as
well as Google spreadsheets). It is even possible to access different
worksheets in the <code>xls</code> documents.</p>
<p><strong>But</strong></p>
<ul>
<li>this equates to replacing a (simple but manual) export to
<code>csv</code> with additional complexity/dependencies in the data
analysis Python code</li>
<li><strong>data formatting best practices STILL apply</strong></li>
<li>Is there really a good reason why <code>csv</code> (or similar) is
not adequate?</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use .csv file format for data storage and processing</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-06-data-formats-caveats"><p>Content from <a href="06-data-formats-caveats.html">Caveats of popular data and file formats</a></p>
<hr>
<p>Last updated on 2024-10-29 |

        <a href="https://github.com/librarycarpentry/lc-spreadsheets/edit/main/episodes/06-data-formats-caveats.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 5 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What do you need to be aware of when exporting data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Identify problems with using the .csv file format.</li>
<li>Apply best practices for data cleaning to avoid problems with the
.csv file format.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>
  This lesson is for reference
  </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<ul>
<li>This is mainly here as a reference if people have questions about
different file formats. You don’t need to go through this.</li>
</ul>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="dealing-with-commas-as-part-of-data-values-in--csv-files">Dealing with commas as part of data values in <code>*.csv</code>
files<a class="anchor" aria-label="anchor" href="#dealing-with-commas-as-part-of-data-values-in--csv-files"></a>
</h2>
<hr class="half-width">
<p>In the <a href="05-exporting-data.html">previous lesson</a> we
discussed how to export Excel file formats into <code>*.csv</code>.
Comma Separated Value files are indeed very useful allowing for easily
exchanging and sharing data.</p>
<p>However, there are some significant problems with this particular
format. Quite often the data values themselves may include commas (,).
In that case, the software which you use (including Excel) will most
likely incorrectly display the data in columns. It is because the commas
which are a part of the data values will be interpreted as a
delimiter.</p>
<p>Data could look like this:</p>
<pre><code>date,type,len_hours,num_registered,num_attended,trainer,cancelled
29 Apr,OA,1.5,1.5,15,JM,N
3 Mar,OA,60,19,25,PG,N
3 Jul,OA,1,25,20,PG, JM ,N
4 Jan,OA,1,26,17,JM,N
29 Mar,RDM,1,27,24,JM,N</code></pre>
<p>In record <code>3 Jul,OA,1,25,20,PG, JM ,N</code> the value for
<em>trainer</em> includes a comma for multiple trainers
(<code>PG, JM</code>). If we try to read the above into Excel (or other
spreadsheet programme), we will get something like this:</p>
<figure><img src="../fig/csv-mistake.png" alt="Issue with importing csv format" class="figure mx-auto d-block"></figure><p>The value for ‘trainer’ was split into two columns (instead of being
put in one column <code>F</code>). This can propagate to a number of
further errors. For example, the “extra” column will be interpreted as a
column with many missing values (and without a proper header!).</p>
<p>If you want to store your data in <code>csv</code> format and expect
that your data values may contain commas, you can avoid the problem
discussed above by putting the values to be included in the same column
in quotes (““). Applying this rule, the data might look like this:</p>
<pre><code>date,type,len_hours,num_registered,num_attended,trainer,cancelled
29 Apr,OA,1.5,1.5,15,JM,N
3 Mar,OA,60,19,25,PG,N
3 Jul,OA,1,25,20,"PG, JM",N
4 Jan,OA,1,26,17,JM,N
29 Mar,RDM,1,27,24,JM,N</code></pre>
<p>Now opening this file as a <code>csv</code> in Excel will not lead to
an extra column, because Excel will only use commas that fall outside of
quotation marks as delimiting characters. However, if you are working
with an already existing dataset in which the data values are not
included in “” but which have commas as both delimiters and parts of
data values, you are potentially facing a major problem with data
cleaning.</p>
<p>If the dataset you’re dealing with contains hundreds or thousands of
records, cleaning them up manually (by either removing commas from the
data values or putting the values into quotes - ““) is not only going to
take hours and hours but may potentially end up with you accidentally
introducing many errors.</p>
<p>Cleaning up datasets is one of the major problems in many scientific
disciplines. The approach almost always depends on the particular
context. However, it is a good practice to clean the data in an
automated fashion, for example by writing and running a script. The
Python and R lessons will give you the basis for developing skills to
build relevant scripts.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Be careful when using commas in values</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/librarycarpentry/lc-spreadsheets/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/librarycarpentry/lc-spreadsheets/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/librarycarpentry/lc-spreadsheets/" class="external-link">Source</a></p>
				<p><a href="https://github.com/librarycarpentry/lc-spreadsheets/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.7" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://librarycarpentry.github.io/lc-spreadsheets/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://librarycarpentry.github.io/lc-spreadsheets/instructor/aio.html",
  "identifier": "https://librarycarpentry.github.io/lc-spreadsheets/instructor/aio.html",
  "dateCreated": "2018-04-13",
  "dateModified": "2025-01-28",
  "datePublished": "2025-01-28"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

